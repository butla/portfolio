Sample back-end app
===================

A sample back-end app used to illustrate testing and development techniques. TODO

## Setup

Install these tools:
- [Docker](https://docs.docker.com/engine/install/)
- [poetry](https://python-poetry.org/docs/#installation)
- [precommit](https://pre-commit.com/#installation)

Configure `poetry` so it'll create a .venv folder in the project's directory:
```
poetry config virtualenvs.create true
poetry config virtualenvs.in-project true
```

Run `make setup run`.

Now you have a development environment prepared, and you have the application running locally in Docker.

For additional development commands, install:
- [fd](https://github.com/sharkdp/fd?tab=readme-ov-file#installation)
- [entr](https://eradman.com/entrproject/)

## Development operations

The commands are in the Makefile. Please review it.

## Demonstrated techniques

TODO: split into categories, like architecture, SQL, testing, code formatting, local workflow

- application architecture inspired by clean code, TODO explain
- tests:
  - integrated and external (functional / end-to-end) tests with Docker Compose
  - test naming, they are closed to code, easy to find, but they're are omitted from the final app build
    to not bloat the image. tests foldeer close to testing
  - TODO
- static code checks:
  - ruff
- code formatting: ruff does it, can be run through the Makefile or with precommit
- reloading app container on code changes (`make run_reloading`)
- running tests on code changes (`make test_reloading`)
- injectable locally bound container ports - accommodating self-hosted CI runners
- autogenerated SQL migrations
- migrations without the downgrade option. Downgrades create a risk of data loss in a real system.
  If there are issues with the migrations the solution is to provide fixes in new migrations.
- ...others...


## TODOs

- pytest: stop trying to interpret TestsConfig as a test class
  - https://docs.pytest.org/en/7.1.x/example/pythoncollection.html
- show coverage measurements from docker in external tests
- `make check` should also verify that requirements.txt is up to date with poetry dependencies
- Add Github CI for the app that removes docker-compose.override.yml to fully check the app image
- app versioning
